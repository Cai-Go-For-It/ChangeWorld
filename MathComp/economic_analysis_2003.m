% 清除工作区和命令行
clear;
clc;

% --- 1. 数据录入 ---
% 城市名称列表 (注意：原始数据中"南宁"和"海口"重复，这里已去除重复项，只保留第一次出现的数据)
cities = {
    '北京', '天津', '石家庄', '太原', '呼和浩特', '沈阳', '大连', '长春', '哈尔滨', ...
    '上海', '南京', '杭州', '宁波', '合肥', '福州', '厦门', '南昌', '济南', ...
    '青岛', '郑州', '武汉', '长沙', '广州', '深圳', '南宁', '海口', '重庆', ...
    '成都', '贵阳', '昆明', '西安', '兰州', '西宁', '银川', '乌鲁木齐'
};

% 经济指标数据 (每行一个城市，每列一个指标)
% 列顺序：人均GDP、人均工业产值、客运总量、货运总量、地方财政预算内收入、
% 固定资产投资总额、在岗职工占总人口的比例、在岗职工人均工资额、城乡居民年底储蓄余额
data = [
    31886, 33168, 30520, 30671, 593, 2000, 37.8, 25312, 6441;   % 北京
    26433, 43732, 3507, 34679, 205, 934, 18.8, 18648, 1825;    % 天津
    15134, 13159, 11843, 10008, 49, 416, 9.5, 12306, 1044;     % 石家庄
    15752, 15831, 2975, 15248, 33, 197, 22.8, 12679, 660;      % 太原
    18991, 11257, 3508, 4155, 21, 182, 13.5, 14116, 255;       % 呼和浩特
    23268, 15446, 6612, 14636, 81, 557, 14.8, 14961, 1423;     % 沈阳
    29145, 27615, 11001, 21081, 111, 407, 14.7, 17560, 1310;   % 大连
    18630, 21045, 6999, 10892, 46, 294, 12.5, 13870, 831;      % 长春
    14825, 7561, 6458, 9518, 76, 423, 17.7, 12451, 1154;       % 哈尔滨
    46586, 77083, 7212, 63861, 899, 2274, 21.0, 27305, 6055;   % 上海
    27547, 43853, 16790, 14805, 136, 794, 15.4, 22190, 1134;   % 南京
    32667, 49823, 21349, 16815, 150, 717, 11.8, 24667, 1466;   % 杭州
    32543, 47904, 24938, 13797, 139, 555, 10.9, 23691, 1060;   % 宁波
    10621, 11714, 6034, 4641, 36, 245, 8.3, 13901, 359;        % 合肥
    22281, 21310, 9680, 8250, 67, 376, 11.8, 15053, 876;       % 福州
    53590, 93126, 4441, 3055, 70, 238, 38.6, 19024, 397;       % 厦门
    14221, 9205, 5728, 4454, 31, 210, 11.0, 13913, 483;        % 南昌
    23437, 22634, 5810, 14354, 76, 429, 13.5, 16027, 758;      % 济南
    24705, 35506, 14666, 30553, 120, 548, 14.5, 15335, 908;    % 青岛
    16674, 14023, 10709, 7847, 66, 373, 12.7, 13538, 1048;     % 郑州
    21278, 17083, 11882, 16610, 80, 623, 17.4, 13730, 1286;    % 武汉
    15446, 8873, 10609, 10631, 60, 434, 10.0, 16987, 705;      % 长沙
    48220, 55404, 29751, 28859, 275, 1089, 25.1, 28805, 3727;  % 广州
    191838, 347519, 10989, 6793, 291, 875, 69.6, 31053, 2199;  % 深圳
    8176, 3390, 7016, 5893, 36, 170, 8.3, 13171, 451;          % 南宁 (第一次出现)
    16442, 14553, 13284, 3304, 12, 99, 16.5, 14819, 284;       % 海口 (第一次出现)
    7190, 5076, 58290, 32450, 162, 1187, 6.5, 12440, 1897;     % 重庆
    17914, 9289, 72793, 28798, 90, 788, 11.9, 15274, 1494;     % 成都
    11046, 10350, 18511, 5318, 40, 231, 15.8, 12181, 345;       % 贵阳
    16215, 11601, 5126, 12338, 60, 342, 14.6, 14255, 709;       % 昆明
    13140, 8913, 11413, 9392, 65, 446, 15.9, 13505, 1211;       % 西安
    14459, 17136, 2209, 5581, 21, 203, 18.0, 13489, 468;       % 兰州
    7066, 5605, 2788, 2037, 8, 76, 10.1, 14629, 175;           % 西宁
    11787, 11013, 2146, 2127, 12, 134, 21.9, 13497, 193;       % 银川
    22508, 17137, 2188, 12754, 41, 180, 26.1, 16509, 420        % 乌鲁木齐
];

% 指标名称
indicator_names = {
    '人均GDP (元)', '人均工业产值 (元)', '客运总量 (万人)', '货运总量 (万吨)', ...
    '地方财政预算内收入 (亿元)', '固定资产投资总额 (亿元)', '在岗职工占总人口的比例 (%)', ...
    '在岗职工人均工资额 (元)', '城乡居民年底储蓄余额 (亿元)'
};

% --- 2. 数据检查（可选，但推荐） ---
disp('数据维度检查：');
fprintf('城市数量: %d\n', length(cities));
fprintf('数据矩阵行数: %d\n', size(data, 1));
fprintf('指标数量: %d\n', size(data, 2));
fprintf('指标名称数量: %d\n', length(indicator_names));

if length(cities) ~= size(data, 1) || length(indicator_names) ~= size(data, 2)
    error('数据维度不匹配，请检查城市数量或指标数量。');
end

fprintf('\n数据录入完成，准备进行分析...\n');

% --- 3. 描述性统计分析 ---
disp('--- 描述性统计分析 ---');
fprintf('%-25s %10s %10s %10s %10s\n', '指标名称', '均值', '标准差', '最小值', '最大值');
for i = 1:size(data, 2)
    col_data = data(:, i);
    fprintf('%-25s %10.2f %10.2f %10.2f %10.2f\n', ...
            indicator_names{i}, mean(col_data), std(col_data), min(col_data), max(col_data));
end

% --- 4. 单指标排名与可视化 ---
disp('--- 单指标排名分析 (TOP 5 & BOTTOM 5) ---');

% 循环处理每个指标
for i = 1:size(data, 2)
    current_indicator_data = data(:, i);

    % 排序并获取索引
    [sorted_data, sorted_indices] = sort(current_indicator_data, 'descend'); % 降序排列

    fprintf('\n--- %s ---\n', indicator_names{i});

    % 显示TOP 5
    fprintf('**表现最佳 (TOP 5):**\n');
    for j = 1:min(5, length(cities))
        city_idx = sorted_indices(j);
        fprintf('%d. %s: %.2f\n', j, cities{city_idx}, sorted_data(j));
    end

    % 显示BOTTOM 5
    fprintf('\n**表现最差 (BOTTOM 5):**\n');
    [~, sorted_indices_asc] = sort(current_indicator_data, 'ascend'); % 升序排列
    for j = 1:min(5, length(cities))
        city_idx = sorted_indices_asc(j);
        fprintf('%d. %s: %.2f\n', j, cities{city_idx}, current_indicator_data(city_idx));
    end

    % 绘制柱状图 (可以根据需要选择是否绘制所有指标的图)
    % 这里只对几个关键指标进行可视化，避免图过多
    if ismember(i, [1, 2, 5, 6, 9]) % 人均GDP、人均工业产值、地方财政收入、固定资产投资、储蓄余额
        figure;
        bar(current_indicator_data);
        set(gca, 'XTickLabel', cities, 'XTickLabelRotation', 45); % 设置x轴标签为城市名称，并旋转
        title(['各城市' indicator_names{i} '分布']);
        ylabel(indicator_names{i});
        xlabel('城市');
        grid on;
        drawnow; % 确保图能立即显示
    end
end

% --- 5. 相关性分析 ---
disp('--- 相关性分析 ---');

% 选择进行相关性分析的指标索引
% 1: 人均GDP， 2: 人均工业产值， 5: 地方财政预算内收入，
% 6: 固定资产投资总额， 9: 城乡居民年底储蓄余额
selected_indices = [1, 2, 5, 6, 9];
selected_data = data(:, selected_indices);
selected_indicator_names = indicator_names(selected_indices);

% 计算相关系数矩阵
correlation_matrix = corrcoef(selected_data);

% 显示相关系数矩阵
disp('以下是部分关键经济指标的相关系数矩阵:');
fprintf('%-25s', '指标');
for k = 1:length(selected_indicator_names)
    fprintf('%15s', selected_indicator_names{k});
end
fprintf('\n');

for r = 1:length(selected_indicator_names)
    fprintf('%-25s', selected_indicator_names{r});
    for c = 1:length(selected_indicator_names)
        fprintf('%15.3f', correlation_matrix(r, c));
    end
    fprintf('\n');
end

% 绘制散点图矩阵 (可选，但直观)
figure;
[H,AX,BigAx,P,PAX] = plotmatrix(selected_data);
title(BigAx, '部分关键经济指标散点图矩阵');
for i = 1:length(selected_indicator_names)
    ylabel(AX(i,1), selected_indicator_names{i}, 'Interpreter', 'none');
    xlabel(AX(length(selected_indicator_names),i), selected_indicator_names{i}, 'Interpreter', 'none');
end


% --- 6. 综合分析与总结 (在Matlab代码中不易直接实现，需要人工解读) ---
disp('--- 综合分析与总结 ---');
disp('请参考以上描述性统计、排名和相关性分析结果，进行人工解读和总结。');
disp('以下是一些可能的分析方向：');
disp('1. 找出在多个重要指标上均表现突出的城市（如：深圳、上海、广州）。');
disp('2. 观察是否存在某些指标上表现好，但在另一些指标上表现一般的城市。');
disp('3. 根据相关性分析，推断不同经济活动之间的潜在联系。例如，高人均GDP通常伴随着高工业产值和较高的财政收入。');
disp('4. 注意一些特殊城市，如厦门的人均GDP和工业产值极高，但客运货运总量相对较低，这可能与城市规模和经济结构有关。');
disp('5. 对比相同区域的城市，分析其经济发展差异。');